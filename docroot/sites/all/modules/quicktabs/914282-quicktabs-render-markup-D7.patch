--- quicktabs.module	2010-05-12 22:28:27.000000000 -0700
+++ quicktabs.module_new	2010-09-17 08:55:34.000000000 -0700
@@ -156,7 +156,6 @@ function quicktabs_block_info() {
 function quicktabs_block_view($delta = '') {
   $block = array();
   if ($quicktabs = quicktabs_load($delta)) {
-    $qt = quicktabs_render($quicktabs);
     $block['subject'] = $quicktabs->title;
     $block['content'] = quicktabs_render($quicktabs);
     if (!empty($block['content'])) {
@@ -275,7 +274,7 @@ function quicktabs_render($quicktabs) {
 
     $qt_ra['content']['active'] = array(
       '#options' => array('attributes' => array('class' => array('qt_temp'))),
-      'content' =>  quicktabs_render_tabpage($quicktabs->tabs[$active_tab]),
+      '#markup' =>  quicktabs_render_tabpage($quicktabs->tabs[$active_tab]),
     );
   }
   else {
@@ -287,8 +286,14 @@ function quicktabs_render($quicktabs) {
             'attributes' => array(
               'id' => 'qt-'. $quicktabs->qtid .'-ui-tabs' . ($key+1),
         )),
-        'content' => quicktabs_render_tabpage($tab),
       );
+      $render = quicktabs_render_tabpage($tab);
+      if (is_array($render)) {
+        $qt_ra['content']['divs'][$key]['content'] = $render;
+      }
+      else {
+        $qt_ra['content']['divs'][$key]['#markup'] = $render;
+      }
     }
   }
   return $qt_ra;
@@ -319,6 +324,7 @@ function quicktabs_ajax_block($bid, $hid
   );
 
   $output = quicktabs_render_tabpage($tabpage);
+  
   return $output;
 }
 
