<?php
/**
 * @file
 * Code for the fmnh arbitrary pane feature.
 */

include_once 'fmnh_arbitrary_pane.features.inc';

/**
 * Implement hook_pane_entity_view_alter().
 *
 * @param $build
 * @param $type
 */
function fmnh_arbitrary_pane_entity_view_alter(&$build, $type) {
  if ($type === 'fieldable_panels_pane' && $build['#bundle'] === 'markup_styles_scripts') {
    $entity = $build['#fieldable_panels_pane'];

    $items = field_get_items($type, $entity, 'field_js');
    if ($items) {
      $build['#attached']['js'][] = array(
        'data' => $items[0]['value'],
        'type' => 'inline'
      );
    }

    $items = field_get_items($type, $entity, 'field_css');
    if ($items) {
      $build['#attached']['css'][] = array(
        'data' => $items[0]['value'],
        'type' => 'inline'
      );
    }
  }
}
