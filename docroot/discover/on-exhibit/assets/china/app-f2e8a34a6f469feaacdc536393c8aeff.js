$(function(){for(var n in svgManifest)$.ajax({url:svgManifest[n],complete:function(n){$(".svgHideContainer").append(n.responseText)}})}),$(function(){$(".moduleContainer").data("header-buffer",-1*$(".stickyHeader").outerHeight())}),window.common=window.common||{},window.common.anchorScrollGraceful={},$(function(){common.anchorScrollGraceful.scrollTo=function(n,o,e,t){return o=o||0,e=e||500,n.length?(window.common.anchorScrollGraceful.scrolling=!0,$("html,body").animate({scrollTop:n.offset().top+o},{duration:e,easing:"easeInOutExpo",done:function(){window.common.anchorScrollGraceful.scrolling=!1,$.isFunction(t)&&t()}}),!1):void 0},$("a[href*=#]").click(function(n){n.preventDefault();var o=$(this.hash),e=o.data("header-buffer"),t=o.data("graceful-scroll-duration");common.anchorScrollGraceful.scrollTo(o,e,t)})}),window.common=window.common||{},window.common.analytics=window.common.analytics||{},window.common.analytics.buyTicketsButtonClick=function(n,o){var e=$(n).attr("href");window.common.analytics.event("ticketing","ticketing-exhibition-microsite-"+o,e)},window.common.analytics.scrollDownButtonClick=function(){window.common.analytics.event("one-page","scroll-down-button-click")},window.common.analytics.sponsorLogoClick=function(n){window.common.analytics.event("one-page","logo-click",n)},window.common.analytics.headerNavClick=function(n){var o=$(n).text();window.common.analytics.event("one-page","header-nav-click",o)},window.common.analytics.jumpNavClick=function(n){var o=$.trim($(n).text());window.common.analytics.event("one-page","jump-nav-click",o)},window.common.analytics.visitClick=function(n){var o=$.trim($(n).text());window.common.analytics.event("one-page","visit-click",o)},window.common.analytics.footerClick=function(n,o){var e=o||$.trim($(n).text());window.common.analytics.event("one-page","footer-click",e)},window.common.analytics.trayClick=function(n,o,e){var t=o||$.trim($(n).text());window.common.analytics.event("one-page","tray-click"+(e?e:""),t)},window.common.analytics.introFMLogoClick=function(){window.common.analytics.event("one-page","intro-fm-logo-click")},window.common.analytics.audioEvent=function(n,o){window.common.analytics.event("one-page",n,o)},window.common.analytics.event=function(n,o,e,t){ga("send","event",n,o,e,t?{nonInteraction:1}:null)},window.common.analytics.changePage=function(){ga("set","page",window.location.pathname+window.location.hash),ga("send","pageview")},function(){window.common=window.common||{},window.common.viewport={},$window=$(window);var n={},o=function(n,o){o=o||$(n);var e=o.offset().top,t=o.outerHeight();return{selector:n,$:o,top:e,bottom:e+t,height:t}};window.common.viewport.track=function(e){n[e]||(n[e]=o(e))};var e=document,t=$(window).height();$window.resize(function(){$.each(n,function(e,t){n[e]=o(e,t.$)}),t=$window.height()}),window.common.viewport.setScrollingElement=function(n){e=n},window.common.viewport.isIn=function(i,a,r){r||common.viewport.track(i),a=isNaN(a)?$(e).scrollTop():a;var c=n[c]||o(i);return a+t>c.top&&c.bottom>a},window.common.viewport.fills=function(i,a,r){r||common.viewport.track(i),a=isNaN(a)?$(e).scrollTop():a;var c=n[c]||o(i);return a>c.top&&c.bottom>a+t},window.common.viewport.breakpoints={0:{name:"phone",mq:null},751:{name:"tablet",mq:null},1026:{name:"desktop",mq:null}},window.common.viewport.size=function(){var n=0;for(var o in common.viewport.breakpoints){var e=common.viewport.breakpoints[o].mq=common.viewport.breakpoints[o].mq||window.matchMedia("(min-width: "+o+"px)");e.matches&&(n=Math.max(parseInt(o),n))}return common.viewport.breakpoints[n].name}}(),function(){function n(n){o.push(n)}var o=[];window.common.onScroll=n,$(function(){var n=$(document),e=n.scrollTop();$(document).scroll(function(){var t=n.scrollTop(),i=t>e;for(var a in o)o[a](i,t,e);e=t})})}(),function(){var n={},o={},e={},t={},i={},a={},r=[];window.common.viewport.onEnter=function(o,t){n[o]=window.common.viewport.isIn(o),e[o]=e[o]||[],e[o].push(t)},window.common.viewport.onExit=function(o,e){n[o]=window.common.viewport.isIn(o),t[o]=t[o]||[],t[o].push(e)},window.common.viewport.onFill=function(n,e){o[n]=window.common.viewport.fills(n),i[n]=i[n]||[],i[n].push(e)},window.common.viewport.onUnfill=function(n,e){o[n]=window.common.viewport.fills(n),a[n]=a[n]||[],a[n].push(e)},window.common.viewport.onBreakpointChanged=function(n){r=r||[],r.push(n)},common.viewport.size();for(var c in common.viewport.breakpoints)!function(){var n=common.viewport.breakpoints[c],o=n.mq;o.addListener(function(){$.each(r,function(n,o){o()})})}();window.common.onScroll(function(n,o,r){$.each(e,function(e,t){!window.common.viewport.isIn(e,o)||o!=r&&window.common.viewport.isIn(e,r)||$.each(t,function(o,e){e(n)})}),$.each(t,function(e,t){window.common.viewport.isIn(e,o)||o!=r&&!window.common.viewport.isIn(e,r)||$.each(t,function(o,e){e(n)})}),$.each(i,function(e,t){!window.common.viewport.fills(e,o)||o!=r&&window.common.viewport.fills(e,r)||$.each(t,function(o,e){e(n)})}),$.each(a,function(e,t){window.common.viewport.fills(e,o)||o!=r&&!window.common.viewport.fills(e,r)||$.each(t,function(o,e){e(n)})})})}(),function(){window.common=window.common||{},window.common.urlState={},window.common.urlState.set=function(n){return window.history.pushState?(window.history.pushState(null,null,n),o(),!1):!0};var n=[];window.common.urlState.onChange=function(o){n.push(o)};var o=function(o,e){var e=location.pathname;for(var t in n)n[t](e)};$(function(){$(window).on("popstate",o)})}(),window.common.analytics.scrollDown=function(n){window.common.analytics.event("one-page","scroll-down","page-"+n,!0)},window.common.analytics.moduleHover=function(n,o){var e=o||$.trim($(n).text());window.common.analytics.event("one-page-menu","hover",e,!0)},window.common.analytics.moduleClick=function(n,o){var e=o||$.trim($(n).text());window.common.analytics.event("one-page-menu","click",e)},window.common.analytics.videoEvent=function(n,o){window.common.analytics.event("one-page","video-"+n,o)},window.common.analytics.videoEventNoninteraction=function(n,o){window.common.analytics.event("one-page","video-"+n,o,!0)},window.common.analytics.catalogClick=function(n){var o=$(n).text();window.common.analytics.event("one-page","catalog-click",o)},window.common.analytics.footerHover=function(n,o){var e=o||$.trim($(n).text());window.common.analytics.event("one-page","footer-hover",e,!0)},common.analytics.navClick=function(n){var o=$(n).find("figcaption h2").text();$("body").hasClass("somethingSelected")?common.analytics.footerClick(null,o):common.analytics.moduleClick(null,o)},$(function(){var n=$("body");common.viewport.onEnter(".sharedStories .teaser",function(o){o&&!n.hasClass("somethingSelected")&&common.analytics.scrollDown(1)}),common.viewport.onEnter("footer",function(o){o&&!n.hasClass("somethingSelected")&&common.analytics.scrollDown(2)}),$(".module .teaser").on("mouseover",function(){var o=$(this).find("figcaption h2").text();n.hasClass("somethingSelected")?common.analytics.footerHover(null,o):common.analytics.moduleHover(null,o)});var o=["play","pause","resume","replay","scroll-in","scroll-pause","scroll-resume","pause-other-played","pause-navigate","scrub","volume","stop","watch-50%","watch-100%"];$(".playerContainer video").each(function(n,e){$.each(o,function(n,o){$(e).on("china-player-"+o,function(n,e){common.analytics.videoEvent(o,e)})})})});var customPath="/discover/on-exhibit/china/",browserName,browserVersion,webfontType;if("undefined"==typeof woffEnabled)var woffEnabled=!0;var svgEnabled=1,woff2Enabled=1;if("undefined"!=typeof customPath)var path=customPath;else{var scripts=document.getElementsByTagName("SCRIPT"),script=scripts[scripts.length-1].src;script.match("://")||"/"==script.charAt(0)||(script="./"+script),path=script.replace(/\\/g,"/").replace(/\/[^\/]*\/?$/,"")}var wfpath=path+"/webfonts/",browsers=[{regex:"MSIE (\\d+\\.\\d+)",versionRegex:"new Number(RegExp.$1)",type:[{version:9,type:"woff"},{version:5,type:"eot"}]},{regex:"Trident/(\\d+\\.\\d+); (.+)?rv:(\\d+\\.\\d+)",versionRegex:"new Number(RegExp.$3)",type:[{version:11,type:"woff"}]},{regex:"Firefox[/s](\\d+\\.\\d+)",versionRegex:"new Number(RegExp.$1)",type:[{version:3.6,type:"woff"},{version:3.5,type:"ttf"}]},{regex:"Chrome/(\\d+\\.\\d+)",versionRegex:"new Number(RegExp.$1)",type:[{version:36,type:"woff2"},{version:6,type:"woff"},{version:4,type:"ttf"}]},{regex:"Mozilla.*Android (\\d+\\.\\d+).*AppleWebKit.*Safari",versionRegex:"new Number(RegExp.$1)",type:[{version:4.1,type:"woff"},{version:3.1,type:"svg#wf"},{version:2.2,type:"ttf"}]},{regex:"Mozilla.*(iPhone|iPad).* OS (\\d+)_(\\d+).* AppleWebKit.*Safari",versionRegex:"new Number(RegExp.$2) + (new Number(RegExp.$3) / 10)",unhinted:!0,type:[{version:5,type:"woff"},{version:4.2,type:"ttf"},{version:1,type:"svg#wf"}]},{regex:"Mozilla.*(iPhone|iPad|BlackBerry).*AppleWebKit.*Safari",versionRegex:"1.0",type:[{version:1,type:"svg#wf"}]},{regex:"Version/(\\d+\\.\\d+)(\\.\\d+)? Safari/(\\d+\\.\\d+)",versionRegex:"new Number(RegExp.$1)",type:[{version:5.1,type:"woff"},{version:3.1,type:"ttf"}]},{regex:"Opera/(\\d+\\.\\d+)(.+)Version/(\\d+\\.\\d+)(\\.\\d+)?",versionRegex:"new Number(RegExp.$3)",type:[{version:24,type:"woff2"},{version:11.1,type:"woff"},{version:10.1,type:"ttf"}]}],browLen=browsers.length,suffix="",i=0;n:for(;browLen>i;i++){var regex=RegExp(browsers[i].regex);if(regex.test(navigator.userAgent)){browserVersion=eval(browsers[i].versionRegex);var typeLen=browsers[i].type.length;for(j=0;j<typeLen;j++)if(browserVersion>=browsers[i].type[j].version&&(1==browsers[i].unhinted&&(suffix="_unhinted"),webfontType=browsers[i].type[j].type,"woff"!=webfontType||woffEnabled)&&("woff2"!=webfontType||woff2Enabled)&&("svg#wf"!=webfontType||svgEnabled))break n}else webfontType="woff"}/(Macintosh|Android)/.test(navigator.userAgent)&&"svg#wf"!=webfontType&&(suffix="_unhinted");var head=document.getElementsByTagName("head")[0],stylesheet=document.createElement("style");stylesheet.setAttribute("type","text/css"),head.appendChild(stylesheet);for(var fonts=[{fontFamily:"FFBauWeb",url:wfpath+"2E3942_0"+suffix+"_0."+webfontType},{fontFamily:"FFBauWebItalic",url:wfpath+"2E3942_1"+suffix+"_0."+webfontType},{fontFamily:"FFBauWebBold",url:wfpath+"2E3942_2"+suffix+"_0."+webfontType}],len=fonts.length,css="",i=0;len>i;i++){var format="svg#wf"==webfontType?'format("svg")':"ttf"==webfontType?'format("truetype")':"eot"==webfontType?"":'format("'+webfontType+'")',css=css+("@font-face{font-family: "+fonts[i].fontFamily+";src:url("+fonts[i].url+")"+format+";");fonts[i].fontWeight&&(css+="font-weight: "+fonts[i].fontWeight+";"),fonts[i].fontStyle&&(css+="font-style: "+fonts[i].fontStyle+";"),css+="}"}stylesheet.styleSheet?stylesheet.styleSheet.cssText=css:stylesheet.innerHTML=css,china={},$(function(){var n=document,o=window,e=(n.body,$(o),$("html"),$(".stickyHeader").height()),t=$(".stickyHeader"),i=$(".nav--primary"),a=!0;window.china.mobileNav={enable:function(){a=!0},disable:function(){"desktop"===common.viewport.size()&&t.addClass("is-visible is-fixed"),a=!1}},"desktop"===common.viewport.size()&&common.onScroll(function(n,o){a&&(n?(t.removeClass("is-visible"),o>e&&!t.hasClass("is-fixed")&&t.addClass("is-fixed")):o>0&&t.hasClass("is-fixed")?t.addClass("is-visible"):t.removeClass("is-visible is-fixed"))}),$(".nav__trigger").on("click",function(){$(".menu__icon").toggleClass("is-clicked"),t.toggleClass("menu-is-open"),i.hasClass("is-visible")?i.removeClass("is-visible").one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){$("body").removeClass("overflow-hidden")}):i.addClass("is-visible").one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){$("body").addClass("overflow-hidden")})})}),window.common.debounce=function(n,o,e){var t;return function(){var i=this,a=arguments,r=function(){t=null,e||n.apply(i,a)},c=e&&!t;clearTimeout(t),t=setTimeout(r,o),c&&n.apply(i,a)}},china.scrollPanels=null,function(){function n(){var n,o=this,e=!0;o.enabled=function(n){null!=n&&(e=n)},o.isEnabled=function(){return e&&"desktop"===common.viewport.size()};var t=[],i=0,a=[],r=20,c=null,s=null,l=function(){var n=0,o=0,e=a.length/2;return r/2>e?!1:($.each(a,function(t){t>e?n+=this:o+=this}),console.log(n/e>o/e),n/e>o/e)},u=function(n,o){for(clearInterval(c),a.push(Math.abs(o)),console.log(a);a.length>r;)a.shift();n!=f&&(v(n),a=[],d=!0),l()?d||(d=!0,v(n)):d=!1,f=n,s=r,c=setInterval(function(){for(a.push(0);a.length>r;)a.shift();s--||clearInterval(c),console.log(a)},10)},m=!1,d=!1,f=null,w=!1,p=null,v=function(n){if(!w){w=!0,p=n;var o=Math.min(Math.max(i+(n?1:-1),0),t.length-1);o!=i?(i=o,common.anchorScrollGraceful.scrollTo($(t[i]),-80,null,function(){w=!1})):w=!1}},h=function(n){w=!0,i=n,common.anchorScrollGraceful.scrollTo($(t[n]),-80,null,function(){w=!1})},y=function(){var o=n.scrollTop(),e=null,i=null;t.each(function(n){var t=$(this).offset().top,a=Math.abs(o-t);return null!=i&&a>i?(e=n-1,!1):void(i=a)}),e=null==e?t.length-1:e,h(e)},g=function(){n=$(document),t=$(".scrollSnapSection"),n.on("wheel",function(n){if(!o.isEnabled())return!0;var e=n.originalEvent.wheelDelta||-1*n.originalEvent.deltaY;return Math.abs(e)>3&&u(0>e,e),!1}),n.on("mousedown",function(){return o.isEnabled()?void $(document).on("scroll.scrollpanels",function(){return o.isEnabled()?void(m=!0):!0}):!0});var e=common.debounce(function(){return o.isEnabled()?void y():!0},250);$window.on("resize",function(){e()}),n.on("mouseup",function(){return o.isEnabled()?(m&&y(),$(document).off(".scrollpanels"),void(m=!1)):!0}),n.on("keydown",function(n){if(!o.isEnabled())return!0;switch(n.which){case 40:return v(!0),!1;case 38:return v(!1),!1;case 34:return v(!0),!1;case 33:return v(!1),!1;case 32:return v(!0),!1}}),delete g};g()}$(function(){china.scrollPanels=new n})}(),$(function(){var n=$("body"),o=function(n){return n.replace(/\/$/,"").split("/").pop()},e=function(o){var e="china"==o;e?(n.removeClass("somethingSelected"),china.mobileNav.disable()):(n.addClass("somethingSelected"),china.mobileNav.enable()),china.scrollPanels.enabled(e)},t=function(n){var t=o(n);e(t),$(".selected").removeClass("selected"),$(".stub--"+t).addClass("selected"),$(document).scrollTop(0),common.analytics.changePage()};common.urlState.onChange(t),e(o(location.pathname))}),$(function(){china.bitShaver={},china.bitShaver.enableImage=function(n){n.attr("src",n.attr("data-src")),n.attr("srcset",n.attr("data-srcset"))},china.bitShaver.enableVideo=function(n){var o=n.parent();n.detach(),n.attr("src",n.attr("data-src")),n.attr("data-src",""),o.append(n)};var n=function(){var n=common.viewport.size();return"tablet"==n?"desktop":n},o=function(){$(".selected, .moduleContainer").find("img").each(function(){var o=$(this);o.hasClass("phone")||o.hasClass("desktop")?o.hasClass(n())&&china.bitShaver.enableImage(o):china.bitShaver.enableImage(o)}),$(".selected").find(".playerContainer:not(.playerContainer--full) video source").each(function(){china.bitShaver.enableVideo($(this))})};common.urlState.onChange(o),common.viewport.onBreakpointChanged(o),o()}),function(){function n(n){var o=this;const e=5e3;var t=null,i=null,a=null,r=null,c=null,s=null,l=null,u=null,m=!1,d=!1,f=0,w=null,p=null,v=null,h=function(){return(new Date).getTime()},y=function(){return w},g=function(){return!w},b=function(n){c.trigger("china-player-"+n,c.attr("id"))};o.isPlaying=function(){return i},o.setIdle=function(){a.addClass("muted"),r.muted=!0,r.loop=!0,t=!0,i=!1},o.play=function(){t&&(a.removeClass("muted"),r.currentTime=0,r.muted=!1,r.loop=!1,t=!1),m?b(d?"replay":"resume"):(b("play"),m=!0),a.removeClass("paused stopped ended"),$.each(china.players,function(){this.clearLastScrollStop(),this.isPlaying()&&o!=this&&(b("pause-other-played"),this.pause())}),r.play(),i=!0},o.pause=function(){i&&C()},o.clearLastScrollStop=function(){u=0},o.pauseLeavePage=function(){i&&(C(),b("pause-navigate"))};var C=function(){a.removeClass("ended immediate"),a.addClass("paused"),r.pause(),i=!1};o.ended=function(){a.removeClass("immediate"),a.addClass("paused ended"),g()&&a.addClass("stopped"),i=!1,b("watch-100%"),d=!0},o.error=function(){a.addClass("error")},o.setTime=function(n){i&&f/r.duration<.5&&n/r.duration>=.5&&b("watch-50%");var o=Math.floor(n);s.text(Math.floor(o/60)+":"+("0"+o%60).slice(-2)),f=n};var x=function(n,o,e){var n=n,t=r.duration,i=100*n/t,a=i*(e?-1:1)+(e?100:0),c=o?2*Math.round(a/2):a;return c+"%"};o.updateProgress=function(){if(i){var n=(r.duration,a.find(".loaded"));if(r.buffered.length!=n.length){n.remove();for(var o=a.find(".progress"),e=0;e<r.buffered.length;e++)o.append('<span class="loaded"></span>');n=a.find(".loaded")}for(var e=0;e<r.buffered.length;e++)n.eq(e).css({left:x(r.buffered.start(e),!0),right:x(r.buffered.end(e),!0,!0)});l.css("width",x(r.currentTime))}};var k=function(n,o,e,t,a){e=e||0,n.on("mousedown",function(n){b(a);var c=$(this).width(),s=n.offsetX,l=n.pageX;t&&r.pause(),o(E(c,s,l,l,e)),$(document).on("mousemove.scrubbing",function(n){o(E(c,s,l,n.pageX,e))}).on("mouseup.scrubbing",function(n){$(document).off(".scrubbing"),o(E(c,s,l,n.pageX,e)),i&&t&&r.play(),isScrubbing=!1})}).on("click",function(){return!1})},E=function(n,o,e,t,i){var a=t-e+o,r=Math.max(Math.min(a,n-i),i);return(1*r-i)/(n-2*i)},S=function(n){r.currentTime=n*r.duration},T=function(n){var o=n,e=Math.floor(4*n);p!=e&&(p=e,a.removeClass("volume-0 volume-1 volume-2 volume-3 volume-4").addClass("volume-"+p)),v!=o&&(v=o,r.volume=v)},I=function(){if(a.hasClass("loading")||a.hasClass("error"))return!1;if(i&!r.paused)o.pause(),b("pause");else{if(g()&&r.readyState<3)return a.addClass("loading"),c.one("canplay",function(){a.removeClass("loading"),o.play()}),void r.load();o.play()}},M=!1,N=function(n,a,r){if(!M){M=!0,a.removeClass("loading");var c="#"+n.attr("id");common.viewport.onEnter(c,function(){a.is(":visible")&&(t?(r.play(),b("scroll-in")):u>h()-e&&(a.addClass("immediate"),o.play(),b("scroll-resume")))}),common.viewport.onExit(c,function(){t?r.pause():i&&(o.pause(),b("scroll-pause"),u=h())}),common.viewport.isIn(c)&&t&&r.play()}},R=function(){if(a=$(n),c=a.find("video"),r=c[0],c.on("canplay",function(){N(c,a,r)}),r.readystate>3&&N(c,a,r),a.click(I),c.on("ended",function(){o.ended()}),c.on("error",function(){o.error(),a.unbind("click")}),l=a.find(".viewed"),c.on("timeupdate",function(){o.updateProgress()}),c.on("play",function(){a.removeClass("paused")}),k(a.find(".progress"),S,null,!0,"scrub"),w=a.hasClass("playerContainer--person"),y())o.setIdle();else if(g()){N(c,a,r),s=a.find(".time"),c.on("timeupdate",function(){o.setTime(r.currentTime)});var e=function(){return o.pause(),a.addClass("stopped"),b("stop"),!1};a.find(".player__modal").click(e),a.find(".stop").click(e),a.find(".player__modal__container").click(function(){return!1}),a.find(".playPause, .player__video").click(I),k(a.find(".volume"),T,16,null,"volume")}};R(),delete R}$(function(){china.players=[],$(".playerContainer").each(function(){player=new n(this),china.players.push(player)}),common.urlState.onChange(function(){$.each(china.players,function(){this.pauseLeavePage()})})})}();