function Canvas(n){var t,e,i,r,u=this,a=1,o=n,c=null;u.isVisible=function(){return o.is(":visible")},u.resize=function(){r=o[0].width=o.width()*a,c=o[0].height=o.height()*a},u.width=function(){return r},u.height=function(n){return n&&(o.height(n),u.resize()),c},u.clear=function(){i.clearRect(0,0,r,c)};var h=function(n){if(0==n.swidth||0==n.dwidth||0==n.sheight||0==n.dheight)return!1;return n.sx<0&&(n.dx-=n.sx,n.sx=0),n.swidth>n.image.naturalWidth-n.sx&&(n.swidth=n.image.naturalWidth-n.sx,n.dwidth=n.swidth),!0};u.drawImage=function(n){return h(n)?(n.sx||n.sy||n.swidth||n.sheight?i.drawImage(n.image,n.sx,n.sy,n.swidth,n.sheight,n.dx,n.dy,n.dwidth,n.dheight):n.dx||n.dy||n.dwidth||n.dheight?i.drawImage(n.image,n.dx,n.dy,n.dwidth,n.dheight):i.drawImage(n.image,n.dx,n.dy),!0):!1};var s=function(){i=o[0].getContext("2d"),t=window.devicePixelRatio||1,e=i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1,"undefined"==typeof auto&&(auto=!0),auto&&t!==e&&(a=t/e,i.scale(a,a)),delete s};s()}function ImageRepo(){var n=this,t=window.devicePixelRatio||1,e={};n.pixels=function(n){return n*t},n.fromUrl=function(n,i,r,u){var a=1==t?n:i,o=1==t?r:u,c=e[a];if(c)return c;var h=(new Date).getTime(),s=new Image;return s.src=a,e[a]=s,o&&s.load(function(){bpms=o/((new Date).getTime()-h)}),s},n.loaded=function(n,t){n.complete?t():n.onload=t}}function Menu(n){var t=this;t.initialWidth=n;var e=t.initialWidth;t.left=function(n){return(n-t.width())/2},t.width=function(n){return n?void(e=n):e},t.slices=[],t.selectNone=function(){for(var n in t.slices)t.slices[n].selected=!1}}function Slice(n,t,e){var i=this,r=n,u=1/6;i.id=t,i.selected=!1,i.select=function(){n.selectNone(),i.selected=!0},i.heroUrls=e;var a=e.heroThumbOffset||0,o=e.heroOffCenter||50;i.heroThumbTransitionPercent=0,i.heroOffset=function(n){return a*(i.heroThumbTransitionPercent/100)+(o-50)/100*-1*n*((100-i.heroThumbTransitionPercent)/100)},i.fractionWidth=function(n){return void 0===n?u:void(u=n)},i.pixelWidth=function(){return r.width()*u};var c=function(){n.slices.push(i),delete c};c()}function Tween(n,t,e,i,r,u){var a=this;a.running=!1;var o=function(){return(new Date).getTime()};a.run=function(){var c=Math.abs(e-t)/i*1e3,h=o();a.running=!0;var s=function(){var i=o();i>=h+c?(a.running=!1,n(e),r&&r()):n(Easie[u||"quadOut"](i-h,t,e-t,c)),a.running&&requestAnimationFrame(s)};requestAnimationFrame(s)},a.stop=function(){a.running=!1}}function HeroCanvas(n,t,e){var i,r,u,a,o,c=this,h=null;c.resizeCanvas=function(){u.resize(),h.expanded&&h.width(u.width()),l()};var s=function(n,t,e,i,r){for(var a=0;t>=a;a+=i-10)u.drawImage({image:n,sx:6*i+5,sy:0,swidth:i-10,sheight:r,dx:a,dy:0,dwidth:i-10,dheight:64*r/50})},l=function(){if(u.isVisible()){u.clear();var n=0,t=u.width(),e=u.height();i||v();var r=i.naturalWidth/7,a=i.naturalHeight;i.complete&&s(i,t,e,r,a);var o=0;for(var c in h.slices){var l=h.slices[c],d=l.pixelWidth();l.selected&&u.isVisible()&&!l.hero&&f(l);var w=l.selected?l.hero:i,g=h.left(t)+o;o+=d;var I=w.naturalHeight,M=l.selected?I:a,m=l.selected?(l.hero.naturalWidth-d)/2+l.heroOffset(t):r*n+(r-d)/2,x=d,p=x,b=I;u.drawImage({image:w,sx:m,sy:0,swidth:x,sheight:M,dx:g,dy:0,dwidth:p,dheight:b}),n++}}};c.collapseMenu=function(n,t){h.expanded=!1,a&&a.stop(),o=new Tween(function(n){h.width(n),l()},h.width(),h.initialWidth,2500,t),o.run()},c.expandMenu=function(n,t){return h.expanded=!0,o&&o.stop(),n?void h.width(u.width()):(a=new Tween(function(n){h.width(n),l()},h.width(),u.width(),2500,t),void a.run())};var d=function(n){var t={};for(var e in n)t[e]=h.slices[e].fractionWidth();return t};c.deselect=function(n,t){if(somethingSelected=!1,n){for(var e in h.slices)h.slices[e].fractionWidth(1/6);return u.height(500),t(),void h.selectNone()}var i=d(h.slices);tween=new Tween(function(n){u.height(n),l()},640,500,200,function(){tween=new Tween(function(n){for(var t in h.slices){var e=h.slices[t];e.heroThumbTransitionPercent=n;var r=i[t];e.fractionWidth(r+(1/6-r)*(n/100))}l()},0,100,200,function(){h.selectNone(),t()}),tween.run()}),tween.run()};var f=function(n){n.hero=r.fromUrl(n.heroUrls.hero,n.heroUrls.heroRetina)},w=function(n,t){for(var e in h.slices){var i=h.slices[e];i.fractionWidth(i===n?1:0)}u.height(640),l(),t()};c.select=function(n,t,e){h.expanded||c.expandMenu(t),somethingSelected=!0;var i=h.slices[n];return u.isVisible()?(f(i),void r.loaded(i.hero,function(){i.select();var n=d(h.slices);return t?void w(i,e):(tween=new Tween(function(t){for(var e in h.slices){var r=h.slices[e];r.heroThumbTransitionPercent=t;var u=n[e];r.fractionWidth(r===i?u+(1-u)*(100-t)/100:t*u/100)}l()},100,0,200,function(){u.height()<r.pixels(640)?(tween=new Tween(function(n){u.height(n),l()},500,640,200,e()),tween.run()):e()}),void tween.run())})):(i.select(),void w(i,e))};var v=function(){i=r.fromUrl(t.sprite,t.spriteRetina),r.loaded(i,function(){l()})},g=function(){r=new ImageRepo,h=new Menu(r.pixels(500));for(var t=0;6>t;t++)new Slice(h,t,e[t]);u=new Canvas(n,h),c.resizeCanvas(),delete g};g()}(function(){this.Easie=function(){function n(){}return n.linear=function(n,t,e,i){return t+e*n/i},n.backIn=function(n,t,e,i,r){return null==r&&(r=1.70158),e*(n/=i)*n*((r+1)*n-r)+t},n.backOut=function(n,t,e,i,r){return null==r&&(r=1.70158),e*((n=n/i-1)*n*((r+1)*n+r)+1)+t},n.backInOut=function(n,t,e,i,r){return null==r&&(r=1.70158),(n/=i/2)<1?e/2*n*n*(((r*=1.525)+1)*n-r)+t:e/2*((n-=2)*n*(((r*=1.525)+1)*n+r)+2)+t},n.bounceOut=function(n,t,e,i){return(n/=i)<1/2.75?7.5625*e*n*n+t:2/2.75>n?e*(7.5625*(n-=1.5/2.75)*n+.75)+t:2.5/2.75>n?e*(7.5625*(n-=2.25/2.75)*n+.9375)+t:e*(7.5625*(n-=2.625/2.75)*n+.984375)+t},n.bounceIn=function(t,e,i,r){return i-n.bounceOut(r-t,0,i,r)+e},n.bounceInOut=function(t,e,i,r){return r/2>t?.5*n.bounceIn(2*t,0,i,r)+e:.5*n.bounceOut(2*t-r,0,i,r)+.5*i+e},n.circIn=function(n,t,e,i){return-e*(Math.sqrt(1-(n/=i)*n)-1)+t},n.circOut=function(n,t,e,i){return e*Math.sqrt(1-(n=n/i-1)*n)+t},n.circInOut=function(n,t,e,i){return(n/=i/2)<1?-e/2*(Math.sqrt(1-n*n)-1)+t:e/2*(Math.sqrt(1-(n-=2)*n)+1)+t},n.cubicIn=function(n,t,e,i){return e*(n/=i)*n*n+t},n.cubicOut=function(n,t,e,i){return e*((n=n/i-1)*n*n+1)+t},n.cubicInOut=function(n,t,e,i){return(n/=i/2)<1?e/2*n*n*n+t:e/2*((n-=2)*n*n+2)+t},n.elasticOut=function(n,t,e,i,r,u){var a;return null==r&&(r=null),null==u&&(u=null),0===n?t:1===(n/=i)?t+e:(null==u&&(u=.3*i),null==r||r<Math.abs(e)?(r=e,a=u/4):a=u/(2*Math.PI)*Math.asin(e/r),r*Math.pow(2,-10*n)*Math.sin(2*(n*i-a)*Math.PI/u)+e+t)},n.elasticIn=function(n,t,e,i,r,u){var a;return null==r&&(r=null),null==u&&(u=null),0===n?t:1===(n/=i)?t+e:(null==u&&(u=.3*i),null==r||r<Math.abs(e)?(r=e,a=u/4):a=u/(2*Math.PI)*Math.asin(e/r),n-=1,-(r*Math.pow(2,10*n))*Math.sin(2*(n*i-a)*Math.PI/u)+t)},n.elasticInOut=function(n,t,e,i,r,u){var a;return null==r&&(r=null),null==u&&(u=null),0===n?t:2===(n/=i/2)?t+e:(null==u&&(u=.3*i*1.5),null==r||r<Math.abs(e)?(r=e,a=u/4):a=u/(2*Math.PI)*Math.asin(e/r),1>n?-.5*r*Math.pow(2,10*(n-=1))*Math.sin((n*i-a)*(2*Math.PI/u))+t:r*Math.pow(2,-10*(n-=1))*Math.sin(2*(n*i-a)*Math.PI/u)+e+t)},n.expoIn=function(n,t,e,i){return 0===n?t:e*Math.pow(2,10*(n/i-1))+t},n.expoOut=function(n,t,e,i){return n===i?t+e:e*(-Math.pow(2,-10*n/i)+1)+t},n.expoInOut=function(n,t,e,i){return 0===n?t:n===i?t+e:(n/=i/2)<1?e/2*Math.pow(2,10*(n-1))+t:e/2*(-Math.pow(2,-10*(n-1))+2)+t},n.linearNone=function(n,t,e,i){return e*n/i+t},n.linearIn=function(t,e,i,r){return n.linearNone(t,e,i,r)},n.linearOut=function(t,e,i,r){return n.linearNone(t,e,i,r)},n.linearInOut=function(t,e,i,r){return n.linearNone(t,e,i,r)},n.quadIn=function(n,t,e,i){return e*(n/=i)*n+t},n.quadOut=function(n,t,e,i){return-e*(n/=i)*(n-2)+t},n.quadInOut=function(n,t,e,i){return(n/=i/2)<1?e/2*n*n+t:-e/2*((n-=1)*(n-2)-1)+t},n.quartIn=function(n,t,e,i){return e*(n/=i)*n*n*n+t},n.quartOut=function(n,t,e,i){return-e*((n=n/i-1)*n*n*n-1)+t},n.quartInOut=function(n,t,e,i){return(n/=i/2)<1?e/2*n*n*n*n+t:-e/2*((n-=2)*n*n*n-2)+t},n.quintIn=function(n,t,e,i){return e*(n/=i)*n*n*n*n+t},n.quintOut=function(n,t,e,i){return e*((n=n/i-1)*n*n*n*n+1)+t},n.quintInOut=function(n,t,e,i){return(n/=i/2)<1?e/2*n*n*n*n*n+t:e/2*((n-=2)*n*n*n*n+2)+t},n.sineIn=function(n,t,e,i){return-e*Math.cos(n/i*(Math.PI/2))+e+t},n.sineOut=function(n,t,e,i){return e*Math.sin(n/i*(Math.PI/2))+t},n.sineInOut=function(n,t,e,i){return-e/2*(Math.cos(Math.PI*n/i)-1)+t},n}()}).call(this);